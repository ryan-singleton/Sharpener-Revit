<Project>
  <PropertyGroup>
    <RevitApiPath>C:\Program Files\Autodesk\Revit 2026</RevitApiPath>
    <HasLocalRevitApi Condition="Exists('$(RevitApiPath)\RevitAPI.dll')">true</HasLocalRevitApi>

    <RepoRoot>$(MSBuildThisFileDirectory)..</RepoRoot>
    <DownloadedRevitApiPath>$(RepoRoot)\revit-api</DownloadedRevitApiPath>
    <HasDownloadedRevitApi Condition="Exists('$(DownloadedRevitApiPath)\RevitAPI.dll')">true</HasDownloadedRevitApi>
  </PropertyGroup>

  <ItemGroup Condition="'$(HasLocalRevitApi)' == 'true'">
    <Reference Include="RevitAPI">
      <HintPath>$(RevitApiPath)\RevitAPI.dll</HintPath>
      <Private>false</Private>
    </Reference>

    <Reference Include="RevitAPIUI">
      <HintPath>$(RevitApiPath)\RevitAPIUI.dll</HintPath>
      <Private>false</Private>
    </Reference>
  </ItemGroup>

  <ItemGroup Condition="'$(HasLocalRevitApi)' != 'true' and '$(HasDownloadedRevitApi)' == 'true'">
    <Reference Include="RevitAPI">
      <HintPath>$(DownloadedRevitApiPath)\RevitAPI.dll</HintPath>
      <Private>false</Private>
    </Reference>

    <Reference Include="RevitAPIUI">
      <HintPath>$(DownloadedRevitApiPath)\RevitAPIUI.dll</HintPath>
      <Private>false</Private>
    </Reference>
  </ItemGroup>

  <Target Name="FailIfRevitApiMissing" BeforeTargets="ResolveReferences"
          Condition="'$(HasLocalRevitApi)' != 'true' and '$(HasDownloadedRevitApi)' != 'true'">
    <Error Text="RevitAPI.dll not found. Expected either a local Revit install or downloaded DLLs in 'revit-api'." />
  </Target>

</Project>
